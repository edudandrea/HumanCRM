<div class="page-container">
  <div class="page-header">
    <div class="page-title-group">
      <h1>Cadastro de Clientes</h1>
      <p class="page-subtitle">
        Centralize os dados de clientes, contatos e documentos em um só lugar.
      </p>
    </div>
  </div>

  <!-- Abas principais -->
  <ul class="page-tabs">
    <li
      class="page-tab"
      [class.active]="activeTab === 1"
      (click)="setActiveTab(1)"
    >
      <i class="bi bi-search"></i>
      <span>Pesquisa de Clientes</span>
    </li>
    <li
      class="page-tab"
      [class.active]="activeTab === 2"
      (click)="setActiveTab(2)"
    >
      <i class="bi bi-person-vcard"></i>
      <span>Cadastro de Clientes</span>
    </li>

    <li
      class="page-tab"
      [class.active]="activeTab === 3"
      (click)="setActiveTab(3)"
    >
      <i class="bi bi-graph-up-arrow"></i>
      <span>Prospecção de Clientes</span>
    </li>
    <li
      class="page-tab"
      [class.active]="activeTab === 4"
      (click)="setActiveTab(4)"
    >
      <i class="bi bi-graph-up-arrow"></i>
      <span>Documentos</span>
    </li>
  </ul>

  <!-- TAB 1 - Pesquisa -->

  <div class="surface-card" *ngIf="activeTab === 1">
    <div class="surface-header">
      <div>
        <h2>Pesquisa de Clientes</h2>
        <p>Filtre rapidamente pelos principais dados cadastrais.</p>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group small">
        <label>Código do Cliente</label>
        <input
          type="text"
          placeholder="Código"
          [(ngModel)]="filtroClientes.id"
        />
      </div>
      <div class="form-group" style="position: relative">
        <label>Nome do Cliente</label>
        <input
          type="text"
          placeholder="Nome"
          [(ngModel)]="filtroClientes.nome"
          (input)="pesquisarClientesAutocomplete(filtroClientes.nome)"
          (focus)="pesquisarClientesAutocomplete(filtroClientes.nome)"
          (blur)="fecharListaClientesComDelay()"
          autocomplete="off"
        />

        <ul class="autocomplete" *ngIf="mostrarListaClientes">
          <li
            *ngFor="let c of clientesFiltrados"
            (mousedown)="selecionarClienteDaLista(c)"
          >
            <strong>{{ c.nome }}</strong>
            <small *ngIf="c.cpfCnpj">{{ c.cpfCnpj }}</small>
          </li>
        </ul>
      </div>
      <div class="form-group small">
        <label>CPF/CNPJ</label>
        <input
          type="text"
          placeholder="CPF/CNPJ"
          [(ngModel)]="filtroClientes.cpfCnpj"
        />
      </div>
      <div class="form-group small">
        <label>Telefone</label>
        <input
          type="text"
          placeholder="Telefone"
          [(ngModel)]="filtroClientes.telefone"
        />
      </div>
    </div>

    <div class="actions-row">
      <button
        type="button"
        class="btn-project primary"
        (click)="onPesquisarClick()"
      >
        <i class="bi bi-search"></i>
        Pesquisar
      </button>
      <button
        type="button"
        class="btn-project ghost"
        (click)="openNovoClienteModal(templateNovoCliente)"
      >
        <i class="bi bi-plus-lg"></i>
        Novo Cliente
      </button>
    </div>
  </div>

  <!-- TAB 2 - Cadastro -->
  <div
    class="surface-card"
    *ngIf="activeTab === 2"
    animate.enter="slide-in"
    animate.leave="slide-out"
  >
    <div class="surface-header">
      <div>
        <h2>Dados do Cliente</h2>
        <p>Preencha as informações cadastrais, de contato e documentos.</p>
      </div>
    </div>

    <div class="cliente-form">
      <!-- Cabeçalho -->
      <div class="form-header">
        <div class="form-row">
          <div class="form-group small">
            <label for="codigo">Código do Cliente</label>
            <input
              type="text"
              id="codigo"
              [(ngModel)]="idCliente"
              readonly
              class="readonly-field"
            />
          </div>
          <div class="form-group large">
            <label for="nome">Nome</label>
            <input
              type="text"
              id="nome"
              [(ngModel)]="nome"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group tipo-pessoa-group">
            <label>Tipo de Pessoa</label>
            <div class="pill-toggle">
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'Física'"
                (click)="tipoPessoa = 'Física'"
              >
                Física
              </button>
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'Jurídica'"
                (click)="tipoPessoa = 'Jurídica'"
              >
                Jurídica
              </button>
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'Outros'"
                (click)="tipoPessoa = 'Outros'"
              >
                Outros
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Sub-abas -->
      <div class="sub-tabs">
        <button
          class="sub-tab"
          [class.active]="subTabActive === 1"
          (click)="setActiveSubTab(1)"
        >
          Contato & Endereço
        </button>
        <button
          class="sub-tab"
          [class.active]="subTabActive === 2"
          (click)="setActiveSubTab(2)"
        >
          {{
            tipoPessoa && tipoPessoa === "Jurídica"
              ? "Dados Empresariais"
              : "Dados Pessoais"
          }}
        </button>
      </div>

      <!-- Conteúdo da aba “Contato” -->
      <div class="tab-content" *ngIf="subTabActive === 1">
        <h3>Endereço</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Rua/Avenida</label>
            <input
              type="text"
              id="rua"
              [(ngModel)]="rua"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group small">
            <label>Numero</label>
            <input
              type="number"
              id="numero"
              [(ngModel)]="numero"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Complemento</label>
            <input
              type="text"
              id="Complemento"
              [(ngModel)]="complemento"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group small">
            <label>CEP</label>
            <input
              type="text"
              id="cep"
              [(ngModel)]="cep"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Bairro</label>
            <input
              type="text"
              id="bairro"
              [(ngModel)]="bairro"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Cidade</label>
            <input
              type="text"
              id="cidade"
              [(ngModel)]="cidade"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Estado</label>
            <input
              type="text"
              id="estado"
              [(ngModel)]="estado"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
        </div>

        <h3>Contato</h3>
        <div class="form-row">
          <div class="form-group small">
            <label>Data Cadastro</label>
            <input type="date" />
          </div>
          <div class="form-group small">
            <label>DDD</label>
            <input
              type="number"
              id="ddd"
              [(ngModel)]="ddd"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Telefone</label>
            <input
              type="text"
              id="telefone"
              [(ngModel)]="telefone"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>E-mail</label>
            <input
              type="text"
              id="email"
              [(ngModel)]="email"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Celular/WhatsApp</label>
            <input
              type="text"
              id="celular"
              [(ngModel)]="celular"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Rede Social</label>
            <input
              type="text"
              id="redeSocial"
              name="redeSocial"
              [(ngModel)]="redeSocial"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
            <div class="checkbox-row">
              <label><input type="checkbox" /> Instagram</label>
              <label><input type="checkbox" /> Facebook</label>
              <label><input type="checkbox" /> Twitter</label>
            </div>
          </div>
          <div class="form-group">
            <label>Responsável pelo Contato</label>
            <input
              type="text"
              id="responsavel"
              name="responsavelContato"
              [(ngModel)]="responsavelContato"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Origem do Contato</label>
            <input
              type="text"
              id="origemContato"
              name="origemContato"
              [(ngModel)]="origemContato"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
          <div class="form-group">
            <label>Observações</label>
            <input
              type="text"
              id="observacoes"
              [(ngModel)]="observacoes"
              [readonly]="!podeSalvar"
              [class.readonly-field]="!podeSalvar"
            />
          </div>
        </div>
      </div>

      <!-- Conteúdo da aba Documentos -->
      <div class="tab-content" *ngIf="subTabActive === 2">
        <div class="form-section" *ngIf="tipoPessoa === 'Física'">
          <h3>Documentos – Pessoa Física</h3>
          <div class="form-row">
            <div class="form-group small">
              <label>RG</label>
              <input
                type="text"
                id="rg"
                [(ngModel)]="rg"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group small">
              <label>CPF</label>
              <input
                type="text"
                id="cpf"
                [(ngModel)]="cpfCnpj"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group small">
              <label>Expedidor</label>
              <input
                type="text"
                id="orgaoExpedidor"
                [(ngModel)]="orgaoExpedidor"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group small">
              <label>Sexo</label>
              <select
                [(ngModel)]="sexo"
                [disabled]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              >
                <option [ngValue]="0">Prefiro não informar</option>
                <option [ngValue]="1">Masculino</option>
                <option [ngValue]="2">Feminino</option>
                <option [ngValue]="3">Não binário</option>
              </select>
            </div>
            <div class="form-group small">
              <label>Data de Nascimento</label>
              <input
                type="date"
                id="dataNascimento"
                [(ngModel)]="dataNascimento"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group small">
              <label>Estado Civil</label>
              <select
                [(ngModel)]="estadoCivil"
                [disabled]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              >
                <option [ngValue]="0">Solteiro</option>
                <option [ngValue]="1">Casado</option>
                <option [ngValue]="2">Divorciado</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section" *ngIf="tipoPessoa === 'Jurídica'">
          <h3>Documentos – Pessoa Jurídica</h3>
          <div class="form-row">
            <div class="form-group small">
              <label>CNPJ</label>
              <input
                type="text"
                [(ngModel)]="cpfCnpj"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group">
              <label>Razão Social</label>
              <input
                type="text"
                [(ngModel)]="razaoSocial"
                [readonly]="!podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group small">
              <label>Data da Fundação</label>
              <input type="date" [(ngModel)]="dataFundacao" />
            </div>
            <div class="form-group small">
              <label>Inscrição Estadual</label>
              <input
                type="text"
                [readOnly]="podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group small">
              <label>Inscrição Municipal</label>
              <input
                type="text"
                [readOnly]="podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group small">
              <label>Data do Contato</label>
              <input
                type="text"
                [readOnly]="podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Rede Social</label>
              <input
                type="text"
                [readOnly]="podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
            <div class="form-group">
              <label>Responsável do Contato</label>
              <input
                type="text"
                [readOnly]="podeSalvar"
                [class.readonly-field]="!podeSalvar"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-footer">
      <button
        type="button"
        class="btn-project primary"
        (click)="atualizarCliente()"
        [disabled]="!podeSalvar"
      >
        <i class="fa-regular fa-floppy-disk"></i>
        Salvar
      </button>
      <button type="button" class="btn-project ghost" (click)="alterar()">
        <i class="fa-solid fa-repeat"></i>
        Alterar
      </button>
      <button type="button" class="btn-project cancel" (click)="cancelar()">
        <i class="fa-solid fa-repeat"></i>
        Cancelar
      </button>
      <button
        type="button"
        class="btn-project new"
        (click)="abrirSeletorDocumento()"
      >
        <i class="fa-solid fa-paperclip"></i>
        Adicionar Documentos
      </button>

      <input
        #fileInput
        type="file"
        accept="application/pdf,image/png"
        (change)="onDocumentoSelecionado($event)"
        hidden
      />
    </div>
  </div>

  <!-- TAB 3 - Prospecção de Clientes -->
  <div class="surface-card" *ngIf="activeTab === 3">
    <div class="surface-header">
      <div>
        <h2>Prospecção de Clientes</h2>
      </div>
    </div>

    <!-- Dados do cliente selecionado -->
    <div class="form-row">
      <div class="form-group small">
        <label>Código do Cliente</label>
        <input
          type="text"
          [(ngModel)]="idCliente"
          readonly
          class="readonly-field"
        />
      </div>

      <div class="form-group">
        <label>Nome do Cliente</label>
        <input type="text" [(ngModel)]="nome" readonly class="readonly-field" />
      </div>

      <div class="form-group small">
        <label>CPF/CNPJ</label>
        <input
          type="text"
          [(ngModel)]="cpfCnpj"
          readonly
          class="readonly-field"
        />
      </div>
    </div>

    <!-- FORMULÁRIO DE PROSPECÇÃO -->
    <div class="surface-subcard">
      <!-- BOTÃO DO HISTÓRICO (AQUI É O PONTO CRÍTICO) -->
      <div class="form-row justify-end" *ngIf="prospeccoes.length">
        <button
          type="button"
          class="btn-historico"
          title="Visualizar histórico de prospecções"
          (click)="toggleHistorico()"
          [class.active]="mostrarHistorico"
        >
          <i
            class="fa-solid"
            [ngClass]="
              mostrarHistorico ? 'fa-chevron-up' : 'fa-clock-rotate-left'
            "
          ></i>

          <span>
            {{ mostrarHistorico ? "Ocultar histórico" : "Ver histórico" }}
          </span>

          <span class="badge">
            {{ prospeccoes.length }}
          </span>
        </button>
      </div>

      <h3>Dados da Prospecção</h3>

      <div class="form-row">
        <div class="form-group large">
          <label>Contato da Prospecção</label>
          <input type="text" [value]="nome" readonly />
        </div>

        <div class="form-group small">
          <label>Etapa</label>
          <select [(ngModel)]="prospeccao.etapa">
            <option value="">Selecione...</option>
            <option value="Lead">Lead</option>
            <option value="Contato Inicial">Contato Inicial</option>
            <option value="Proposta Enviada">Proposta Enviada</option>
            <option value="Negociação">Negociação</option>
            <option value="Fechado">Fechado</option>
            <option value="Perdido">Perdido</option>
          </select>
        </div>

        <div class="form-group small">
          <label>Probabilidade (%)</label>
          <input
            type="number"
            min="0"
            max="100"
            [(ngModel)]="prospeccao.probabilidade"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Origem do Contato</label>
          <input type="text" [(ngModel)]="prospeccao.origemContato" />
        </div>

        <div class="form-group">
          <label>Interesse Principal</label>
          <input type="text" [(ngModel)]="prospeccao.interessePrincipal" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Necessidade</label>
          <textarea rows="2" [(ngModel)]="prospeccao.necessidade"></textarea>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group small">
          <label>Próximo Contato</label>
          <input
            type="date"
            id="prosp-dataProximoContato"
            name="prospDataProximoContato"
            [(ngModel)]="prospeccao.dataProximoContato"
          />
        </div>

        <div class="form-group small">
          <label>Canal</label>
          <select [(ngModel)]="prospeccao.canal">
            <option value="">Selecione...</option>
            <option value="Telefone">Telefone</option>
            <option value="WhatsApp">WhatsApp</option>
            <option value="E-mail">E-mail</option>
            <option value="Visita Presencial">Visita Presencial</option>
          </select>
        </div>

        <div class="form-group">
          <label>Responsável</label>
          <input type="text" [(ngModel)]="prospeccao.responsavel" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Observações</label>
          <textarea rows="3" [(ngModel)]="prospeccao.observacoes"></textarea>
        </div>
      </div>

      <!-- HISTÓRICO DE PROSPECÇÕES -->
      <div *ngIf="mostrarHistorico" class="prospeccoes-historico">
        <h4 class="historico-title">Histórico de Prospecções</h4>

        <div
          class="prospeccao-card"
          *ngFor="let p of prospeccoes"
          [class.active]="p.id === prospeccao.id"
          (click)="selecionarProspeccao(p)"
        >
          <div class="card-header">
            <span class="etapa" [ngClass]="p.etapa.toLowerCase()">
              {{ p.etapa }}
            </span>

            <span class="data">
              {{ p.dataCriacao | date: "dd/MM/yyyy HH:mm" }}
            </span>
          </div>

          <p class="observacao">
            {{ p.observacoes || "Sem observações registradas." }}
          </p>

          <div class="card-footer">
            <span class="canal">
              <i class="fa-solid fa-comment-dots"></i>
              {{ p.canal || "—" }}
            </span>

            <span class="responsavel">
              <i class="fa-solid fa-user"></i>
              {{ p.responsavel || "Não informado" }}
            </span>
          </div>
        </div>
      </div>

      <!-- AÇÕES -->
      <div class="form-footer">
        <button
          type="button"
          class="btn-project primary"
          (click)="openNovoProspModal(templateNovoProsp)"
        >
          <i class="fa-regular fa-floppy-disk"></i>
          Nova Prospecção
        </button>
        <button
          type="button"
          class="btn-project new"
          (click)="atualizarProspeccao()"
          [disabled]="!prospeccaoSelecionada"
        >
          <i class="fa-regular fa-floppy-disk"></i>
          Salvar Prospecção
        </button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="activeTab === 4" class="docs-wrap">
  <div class="docs-grid" *ngIf="documentos.length; else vazioDocs">
    <div class="doc-card" *ngFor="let doc of documentos">
      <div class="doc-thumb" (click)="abrirPreview(doc, previewTemplate)">
        <!-- PNG preview -->
        <img
          *ngIf="doc.contentType === 'image/png'"
          [src]="doc.previewUrl"
          alt="preview"
        />

        <!-- PDF thumb -->
        <div *ngIf="doc.contentType === 'application/pdf'" class="pdf-thumb">
          <i class="fa-regular fa-file-pdf"></i>
          <span>PDF</span>
        </div>
      </div>

      <div class="doc-info">
        <div class="doc-name" title="{{ doc.nomeArquivo }}">
          {{ doc.nomeArquivo }}
        </div>
        <div class="doc-meta">{{ doc.contentType }}</div>
      </div>

      <div class="doc-actions">
        <button
          type="button"
          class="doc-btn"
          (click)="abrirPreview(doc, previewTemplate)"
        >
          <i class="fa-regular fa-eye"></i>
        </button>

        <button type="button" class="doc-btn" (click)="downloadDocumento(doc)">
          <i class="fa-solid fa-download"></i>
        </button>

        <button
          type="button"
          class="doc-btn danger"
          (click)="excluirDocumento(doc)"
        >
          <i class="fa-regular fa-trash-can"></i>
        </button>
      </div>
    </div>
  </div>

  <ng-template #vazioDocs>
    <div class="docs-empty">Nenhum documento adicionado ainda.</div>
  </ng-template>

  <!-- Viewer (opcional) -->
  <ng-template #previewTemplate>
  <div class="modal-header preview-header">
    <h5 class="modal-title">
      <i class="fa-regular fa-file"></i>
      {{ documentoAtual?.nomeArquivo }}
    </h5>

    <button
      type="button"
      class="btn-icon close"
      title="Fechar"
      (click)="fecharPreview()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body preview-body">
    <iframe
      *ngIf="documentoAtual?.contentType === 'application/pdf'"
      [src]="documentoAtual?.safeViewerUrl"
      class="viewer-frame"
    ></iframe>

    <img
      *ngIf="documentoAtual?.contentType === 'image/png'"
      [src]="documentoAtual?.previewUrl"
      class="viewer-image"
      alt="imagem"
    />
  </div>

  <div class="modal-footer preview-footer">
    <button
      type="button"
      class="btn-action ghost"
      (click)="downloadDocumento(documentoAtual!)"
    >
      <i class="fa-solid fa-download"></i>
      <span>Download</span>
    </button>

    <button
      type="button"
      class="btn-action danger"
      (click)="excluirDocumento(documentoAtual!)"
    >
      <i class="fa-regular fa-trash-can"></i>
      <span>Excluir</span>
    </button>

    <button
      type="button"
      class="btn-action primary"
      (click)="fecharPreview()"
    >
      <i class="fa-solid fa-check"></i>
      <span>Fechar</span>
    </button>
  </div>
</ng-template>

</div>
<ng-template #templateNovoCliente>
  <div class="modal-content modal-surface">
    <div class="modal-header modal-surface-header">
      <div>
        <h2>Novo Cliente</h2>
        <p>Preencha os dados básicos para cadastrar um novo cliente.</p>
      </div>
      <button
        type="button"
        class="btn-project ghost small-btn"
        (click)="fecharModal()"
      >
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="cliente-form">
        <div class="form-row">
          <div class="form-group large">
            <label for="novo-cli-nome">Nome</label>
            <input
              type="text"
              id="novo-cli-nome"
              name="novoCliNome"
              [(ngModel)]="nome"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="novo-cli-cpfCnpj">CPF/CNPJ</label>
            <input
              type="text"
              id="novo-cli-cpfCnpj"
              name="novoCliCpfCnpj"
              [(ngModel)]="cpfCnpj"
            />
          </div>

          <div class="form-group small">
            <label for="novo-cli-ddd">DDD</label>
            <input
              type="number"
              id="novo-cli-ddd"
              name="novoCliDdd"
              [(ngModel)]="ddd"
            />
          </div>

          <div class="form-group">
            <label for="novo-cli-telefone">Telefone</label>
            <input
              type="number"
              id="novo-cli-telefone"
              name="novoCliTelefone"
              [(ngModel)]="telefone"
            />
          </div>

          <div class="form-group">
            <label for="novo-cli-email">E-mail</label>
            <input
              type="email"
              id="novo-cli-email"
              name="novoCliEmail"
              [(ngModel)]="email"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group small tipo-pessoa-group">
            <label>Tipo de Pessoa</label>
            <div class="pill-toggle">
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'Física'"
                (click)="tipoPessoa = 'Física'"
              >
                Física
              </button>
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'Jurídica'"
                (click)="tipoPessoa = 'Jurídica'"
              >
                Jurídica
              </button>
              <button
                type="button"
                class="pill-option"
                [class.active]="tipoPessoa === 'outros'"
                (click)="tipoPessoa = 'outros'"
              >
                Outros
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer form-footer">
      <button type="button" class="btn-project ghost" (click)="fecharModal()">
        Cancelar
      </button>
      <button
        type="button"
        class="btn-project new"
        (click)="salvarNovoCliente()"
      >
        <i class="fa-regular fa-floppy-disk"></i>
        Salvar Cliente
      </button>
    </div>
  </div>
</ng-template>

<ng-template #templateNovoProsp>
  <div class="modal-content modal-surface">
    <div class="modal-header modal-surface-header">
      <div>
        <h2>Nova Prospecção</h2>
        <p>Preencha os dados básicos para cadastrar uma nova prospecção.</p>
      </div>
      <button
        type="button"
        class="btn-project ghost small-btn"
        (click)="fecharModal()"
      >
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="cliente-form">
        <div class="form-row">
          <div class="form-group large">
            <label for="novo-prosp-contato">Contato da Prospecção</label>
            <input
              type="text"
              id="novo-prosp-contato"
              name="novoProspContato"
              [(ngModel)]="nome"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group small">
            <label for="novo-prosp-prob">Prob (%)</label>
            <input
              type="number"
              id="novo-prosp-prob"
              name="novoProspProb"
              [(ngModel)]="prospeccao.probabilidade"
            />
          </div>

          <div class="form-group">
            <label for="novo-prosp-origem">Origem do Contato</label>
            <input
              type="text"
              id="novo-prosp-origem"
              name="novoProspOrigem"
              [(ngModel)]="prospeccao.origemContato"
            />
          </div>

          <div class="form-group">
            <label for="novo-prosp-necessidade">Necessidade</label>
            <input
              type="text"
              id="novo-prosp-necessidade"
              name="novoProspNecessidade"
              [(ngModel)]="prospeccao.necessidade"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="novo-prosp-interesse">Interesse</label>
          <input
            type="text"
            id="novo-prosp-interesse"
            name="novoProspInteresse"
            [(ngModel)]="prospeccao.interessePrincipal"
          />
        </div>
        <div class="form-row">
          <div class="form-group small">
            <label for="novo-prosp-proximoContato">Próximo Contato</label>
            <input
              type="date"
              id="novo-prosp-proximoContato"
              name="novoProspProximoContato"
              [(ngModel)]="prospeccao.dataProximoContato"
            />
          </div>

          <div class="form-group small">
            <label>Canal</label>
            <select
              id="novo-prosp-canal"
              name="novoProspCanal"
              [(ngModel)]="prospeccao.canal"
            >
              <option value="">Selecione...</option>
              <option value="Telefone">Telefone</option>
              <option value="WhatsApp">WhatsApp</option>
              <option value="E-mail">E-mail</option>
              <option value="Visita Presencial">Visita Presencial</option>
            </select>
          </div>

          <div class="form-group">
            <label for="novo-prosp-responsavel">Responsável</label>
            <input
              type="text"
              id="novo-prosp-responsavel"
              name="novoProspResponsavel"
              [(ngModel)]="prospeccao.responsavel"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="novo-prosp-observacoes">Observações</label>
            <textarea
              id="novo-prosp-observacoes"
              name="novoProspObservacoes"
              rows="3"
              [(ngModel)]="prospeccao.observacoes"
            ></textarea>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer form-footer">
      <button type="button" class="btn-project ghost" (click)="fecharModal()">
        Cancelar
      </button>
      <button
        type="button"
        class="btn-project new"
        (click)="addNovaProspeccao()"
      >
        <i class="fa-solid fa-plus"></i>
        Incluir Prospecção
      </button>
    </div>
  </div>
</ng-template>
